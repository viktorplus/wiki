# grep [OPTIONS] PATTERN [FILE...]

Кратко: `grep` ищет строки, соответствующие шаблону (регулярному выражению) в файлах или потоке ввода.
#grep, #linux, #поиск, #text
---
## Синтаксис

```
grep [OPTIONS] PATTERN [FILE...]
```

Если `FILE` не указан, `grep` читает из stdin.
## Часто используемые опции

- `-i` — игнорировать регистр (case-insensitive)
- `-r` или `-R` — рекурсивный поиск по директориям
- `-n` — показывать номера строк
- `-H` — показывать имя файла (по умолчанию при нескольких файлах)
- `-h` — не показывать имя файла
- `-c` — только счётчик совпадений (количество строк)
- `-v` — инвертировать совпадение (вывести строки, НЕ соответствующие)
- `-l` — вывести только имена файлов с совпадениями
- `-L` — вывести имена файлов без совпадений
- `-o` — выводить только найденные совпадающие фрагменты, по одному на строку
- `-E` — использовать расширенные регулярные выражения (аналог `egrep`)
- `-F` — фиксированные строки (аналог `fgrep`), шаблон как список слов
- `-w` — совпадение только целого слова
- `-A NUM` — показать NUM строк после совпадения (after)
- `-B NUM` — показать NUM строк до совпадения (before)
- `-C NUM` — показать NUM строк контекста вокруг совпадения (context)
- `--color=auto` — подсветка совпадений (часто по умолчанию в дистрибутивах)

## Регулярные сокращения (basic/extended)

- `.` — любой символ
- `*` — 0 или более предыдущего символа/группы
- `^` — начало строки
- `$` — конец строки
- `[]` — набор символов, например `[0-9]`
- `` — граница слова (в GNU grep с `-P` или в `-E`/`-P` при поддержке)
- `
` — экранирование специальных символов

Для более мощных выражений используйте `-E` (ERE) или `-P` (Perl-совместимые):

- `grep -E "colou?r" file` — `u` опционально
- `grep -P "\bword\b" file` — граница слова (Perl-совместимо)

## Примеры

- Найти строку в файле:

```
grep "ошибка" /var/log/syslog
```

- Рекурсивно в каталоге (без бинарных файлов):

```
grep -R --exclude-dir=.git "TODO" ~/projects
```

- Игнорировать регистр и показать номера строк:

```
grep -in "todo" notes.txt
```

- Вывести имена файлов, где есть совпадения:

```
grep -rl "TODO" .
```

- Показать 2 строки контекста вокруг совпадения:

```
grep -C 2 "pattern" file.txt
```

- Инвертировать совпадение (показать строки без шаблона):

```
grep -v "^#" file.conf   # убрать комментарии, начинающиеся с #
```

- Подсчитать количество совпадающих строк:

```
grep -c "pattern" file.txt
```

- Показать только совпадающие фрагменты (полезно при парсинге):

```
grep -oE "[0-9]{4}-[0-9]{2}-[0-9]{2}" access.log   # даты YYYY-MM-DD
```

- Использование с пайпами:

```
dmesg | grep -i "usb"
ps aux | grep myservice | grep -v grep
```

Совет: вместо `ps aux | grep pattern` лучше использовать `pgrep -a pattern`.

## Полезные приёмы

- Исключить директории или файлы по шаблону: `--exclude=*.log`, `--exclude-dir=dir`
- Искать только текстовые файлы: `--binary-files=without-match` (по умолчанию grep старается обнаружить бинарные)
- Подсветка: `GREP_OPTIONS='--color=auto'` (хотя использование GREP_OPTIONS устарело; лучше алиас `alias grep='grep --color=auto'`)
- Быстрая проверка наличия совпадений: `if grep -q "pattern" file; then ...` — `-q` подавляет вывод, возвращает код 0/1

## Производительность

- `-F` (fixed-strings) быстрее для простых подстрок, особенно при большом наборе шаблонов.
- Для очень быстрых поисков по коду используйте `ripgrep (rg)` или `The Silver Searcher (ag)` — они рекурсивны и оптимизированы.

## Ссылки и справка

- Ман страница: `man grep`
- GNU grep manual: https://www.gnu.org/software/grep/manual/

---

Вернуться к [главной странице](./README.md).
