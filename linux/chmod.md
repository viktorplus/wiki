# chmod — шпаргалка

Коротко: `chmod` управляет правами доступа к файлам и каталогам (чтение, запись, выполнение) через символьные или числовые режимы; важно для обеспечения безопасности и корректной работы приложений.
#chmod, #linux, #permissions
---

## Синтаксис

```
chmod [OPTIONS] MODE FILE...
chmod -R 755 /srv/www
```

`MODE` может быть символьным (`u+rwx`) или числовым (`755`). Без указания файлов `chmod` ожидает путь из stdin (редко используется).

## Символьные режимы (чтение/запись/выполнение)

- `u` — владелец (user)
- `g` — группа
- `o` — остальные (others)
- `a` — все три категории (user, group, others)
- `+` — добавить право, `-` — убрать, `=` — установить точно
- `r` — право на чтение, `w` — запись, `x` — выполнение (или переход в каталог)

Примеры:
```
chmod u+x script.sh        # добавить владельцу бит исполнения
chmod go-w file.txt        # убрать запись из группы и остальных
chmod a=r file.txt         # сделать файл только для чтения
```

Можно использовать `X` для добавления выполнения только каталогам или уже исполняемым файлам:
```
chmod a+X somedir/*.sh
```

## Числовые режимы (octal)

Каждый из трёх разрядов (user, group, others) задаёт комбинацию `r=4`, `w=2`, `x=1`. Сложение даёт итоговый бит:

| Биты | Значение | Пояснение |
|------|----------|-----------|
| 0    | ---      | нет прав |
| 1    | --x      | выполнение |
| 2    | -w-      | запись |
| 3    | -wx      | запись+выполнение |
| 4    | r--      | чтение |
| 5    | r-x      | чтение+выполнение |
| 6    | rw-      | чтение+запись |
| 7    | rwx      | все права |

Примеры:
```
chmod 644 file.txt         # rw- для владельца, r-- для груз и остальных
chmod 755 /usr/local/bin/* # стандарт для исполняемых файлов
chmod 700 private.key      # только владелец может читать/писать/исполнять
```

## Спецбитсы: setuid, setgid, sticky

```
chmod 4755 app             # setuid (4) делает программу запускаемой от владельца
chmod 2755 shared/         # setgid (2) унаследует группу каталога
chmod 1777 /tmp            # sticky (1) разрешает удалять файлы только владельцу
```

Комбинировать читается как `chmod 4710 file` (4 + 2 + 1 для спецбитов, затем три цифры для категорий).

## Распространённые опции

- `-R` — рекурсивно применять режим к каталогам и файлам (`chmod -R 755 /var/www`)
- `-f` — подавить сообщения об ошибках
- `-v` — показать изменения (`chmod -v 644 file.txt`)
- `--reference=other` — копировать режим у другого файла: `chmod --reference=template.conf conf.d/app.conf`

## Примеры задач

- Применить пользовательские права только к каталогу и оставить файлы неизменными:
  `chmod 700 ~/secret` (в каталогах не используется `-R`)
- Подготовить веб-директорию:
  `chmod -R u=rwX,go=rX /srv/www`
- Сделать скрипт исполняемым:
  `chmod +x deploy.sh`
- Установить обычные права для SSH-ключей:
  `chmod 600 ~/.ssh/id_rsa`
- Отдать доступ группе, но не остальным:
  `chmod 750 /opt/team/tools`
- Распространить права чтения по маске `umask` (основы): `umask 022` делает `chmod 755` для новых каталогов и `644` для файлов.

## Советы по безопасности

- Никогда не используйте `chmod 777` на файловых системах, доступных другим пользователям
- Для веб-серверов держите статические файлы в `644`, каталоги в `755`
- Храните приватные ключи (`~/.ssh/id_rsa`) как `600`
- Регулярно проверяйте `find /path -perm /o+w -type f` для выявления файлов с записью для остальных

## Справка

- `man chmod`
- GNU Coreutils: https://www.gnu.org/software/coreutils/chmod

---

Вернуться к [главной странице](./README.md).
