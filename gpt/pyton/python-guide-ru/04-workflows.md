# 04 • Рабочие процессы и рецепты

## Репродуцируемые сборки
1. Зафиксируйте зависимости: `pip-compile requirements.in` → `requirements.txt`.
2. Устанавливайте: `pip install -r requirements.txt`.
3. Запускайте тесты и линтеры в CI теми же командами с `python -m`.

## Чек-лист для CI
- Активируйте окружение (если нужно).
- Установите зависимости из фиксированных файлов.
- Запустите `ruff check`, `black --check`, `mypy`, `pytest --cov`.
- Сборка `wheel` и/или тег для релиза.

## Цикл отладки
1. Повторите проблему локально.
2. Добавьте `assert` или `logging` рядом с подозреваемым кодом.
3. Пройдитесь отладчиком или `python -m pdb`.
4. Напишите регрессионный тест и прогоните весь набор.

## Советы по производительности
- Используйте списковые/множественные выражения, не дублируйте вычисления в циклах.
- Меряйте скорость через `timeit` или `python -m timeit`.
- Проанализируйте узкие места `cProfile` или `pyinstrument`.

## Популярные паттерны
- Работа с данными: `pandas`, `numpy`, отдавайте предпочтение векторным операциям.
- CLI: `argparse`, `click` или `Typer`.
- Конфиги: `json`, `yaml`, `tomllib` (Python 3.11+).
- Асинхронность: `asyncio`, `async def`/`await`, используйте `httpx`/`anyio`.

## Документация
- Хостинг: `pydoc` или `python -m http.server`.
- Генерация: `Sphinx` или `MkDocs + mkdocs-material`.

## Безопасность
- `pip install safety` проверяет зависимости.
- Секреты храните вне репозитория (переменные, менеджеры секретов).
- Фиксируйте версии зависимостей, чтобы избегать подмены пакетов.
