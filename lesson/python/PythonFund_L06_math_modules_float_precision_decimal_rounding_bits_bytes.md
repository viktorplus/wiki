# Python Fundamentals — Lesson 6: Math functions, modules, float precision, Decimal (and bits/bytes)

Конспект урока: **встроенные математические функции**, **модули и import**, **модуль `math`**,  
как числа хранятся в памяти (**биты/байты, IEEE 754**), почему `float` даёт погрешности и как лечить это через **`round()` и `decimal.Decimal`**. 

---

## 1) Встроенные математические функции (без импорта)
Python даёт базовые математические функции “из коробки”: 

### `abs(x)` — модуль числа
```py
print(abs(-7))   # 7
print(abs(3.5))  # 3.5
```


### `max(...)` / `min(...)` — максимум/минимум
Можно передавать несколько значений или коллекцию.
```py
print(max(1, 5, 3))        # 5
print(max([2, 8, 4, 1]))   # 8

print(min(2, 8, 4, 1))     # 1
```


### `pow(x, y)` — возведение в степень
```py
print(pow(2, 3))  # 8
print(pow(5, 2))  # 25
```


### `sum(iterable)` — сумма элементов *коллекции*
⚠️ `sum()` принимает **итерируемый объект** (например, список), а не “несколько чисел как аргументы”.
```py
numbers = [1, 2, 3, 4]
print(sum(numbers))  # 10
```
Ошибка из задания:
```py
print(sum(3, 9, 5))  # TypeError
```

### `round(x, ndigits=0)` — округление
```py
print(round(4.56))       # 5
print(round(4.567, 2))   # 4.57
print(round(4.678, 2))   # 4.68
```

---

## 2) Банковское округление (важно!)
В Python `round()` использует **banker’s rounding**: если дробная часть ровно `0.5`, число округляется к **ближайшему чётному**. 

```py
print(round(1.5))  # 2
print(round(2.5))  # 2
print(round(3.5))  # 4
print(round(4.5))  # 4
```

То же для отрицательных:
```py
print(round(-1.5))  # -2
print(round(-2.5))  # -2
```

---

## 3) Модули: что это и зачем
**Модуль** — файл `.py`, содержащий код (функции, классы, переменные, инструкции). 

Зачем нужны:
- **организация кода** (разделение на части),
- **повторное использование**,
- **изоляция** (меньше конфликтов имён). 
---

## 4) `import`: основные способы
4 классических способа импорта: 
### 4.1 Импорт всего модуля
```py
import math
print(math.sqrt(16))
```

### 4.2 Импорт конкретных объектов
```py
from math import sqrt, pi
print(sqrt(16))
print(pi)
```

### 4.3 Импорт с псевдонимом
```py
import math as m
print(m.sqrt(16))
```

### 4.4 Импорт всего содержимого (`*`) — НЕ рекомендуется
```py
from math import *
print(sqrt(16))
```
Почему плохо: засоряет область видимости и легко получить конфликт имён/непонятный код. 

---

## 5) Стандартная библиотека Python
Стандартная библиотека — набор модулей, которые идут вместе с Python: `os`, `sys`, `random`, `re`, `math`, `datetime`, `json` и др. 

---

## 6) Модуль `math`: что полезно знать
`math` — стандартный модуль для математических вычислений. 

Часто используемые:
- `math.sqrt(x)` — корень,
- `math.pow(x, y)` — степень,
- `math.factorial(n)` — факториал,
- `math.ceil(x)` — округление вверх,
- `math.floor(x)` — округление вниз,
- константы `math.pi`, `math.e`,
- тригонометрия: `sin/cos/tan`,
- перевод углов: `degrees()` и `radians()`. 

Примеры:
```py
import math

print(math.sqrt(25))       # 5.0
print(math.factorial(5))   # 120

print(math.ceil(4.3))      # 5
print(math.floor(4.8))     # 4

print(math.pi)             # 3.141592...
print(math.e)              # 2.718281...
```


⚠️ Частая ошибка в заданиях: `print(pi)` после `import math` — **ошибка**, нужно `math.pi` (или `from math import pi`). 

---

## 7) Биты и байты (основа хранения данных)
- **бит**: 0 или 1
- **байт**: 8 бит 
1 байт может хранить:
- **0..255** (беззнаковое представление),
- **-128..127** (знаковое). 

---

## 8) Как числа хранятся в памяти
### 8.1 Целые числа `int`
В низкоуровневом мире есть 32/64-битные целые (диапазон ограничен), но **в Python `int` не имеет фиксированного размера** — размер растёт автоматически при необходимости. 

### 8.2 Вещественные числа `float` (IEEE 754, double)
`float` обычно хранится как 64-битное число:
- 1 бит — знак,
- 11 бит — экспонента,
- 52 бита — мантисса. 

---

## 9) Почему `float` даёт погрешности
Многие десятичные дроби (например, `0.1`) **не представимы точно** в двоичной системе, получается бесконечная двоичная дробь, которую компьютер обрезает. 
Пример:
```py
print(0.1 + 0.2)           # 0.30000000000000004
print(0.1 + 0.2 == 0.3)    # False
```


### 9.1 Что делать на практике
**Вариант 1: округлять** для вывода/сравнения:
```py
a = 0.1 + 0.2
print(round(a, 2))              # 0.3
print(round(a, 2) == 0.3)       # True
```

**Вариант 2: использовать `Decimal`** (финансы/точные расчёты).

---

## 10) `decimal.Decimal`: точная десятичная арифметика
`Decimal` позволяет хранить дробные числа **в десятичном виде** без двоичных артефактов. Особенно полезно в финансах. 

Важно: создавай `Decimal` из **строк**:
```py
from decimal import Decimal

a = Decimal("0.1")
b = Decimal("0.2")
print(a + b)  # 0.3
```


---

## 11) Практика с урока (готовые решения)

### 11.1 Оптовые скидки + округление до сотых
Условия скидки по количеству: 5% / 10% / 15% / 20%, итог округлить до 2 знаков. 

```py
price = float(input("Введите цену товара: "))
quantity = int(input("Введите количество товара: "))

if 10 <= quantity < 20:
    discount = 0.05
elif 20 <= quantity < 50:
    discount = 0.10
elif 50 <= quantity < 100:
    discount = 0.15
elif quantity >= 100:
    discount = 0.20
else:
    discount = 0.0

total = price * quantity * (1 - discount)
print("Сумма заказа с учётом скидки:", round(total, 2))
```

### 11.2 Площадь круга и длина окружности (до сотых)
Формулы:
- `S = π * r^2`
- `C = 2 * π * r` 

```py
import math

r = float(input("Введите радиус: "))
area = math.pi * r ** 2
circ = 2 * math.pi * r

print("Площадь круга:", round(area, 2))
print("Длина окружности:", round(circ, 2))
```

---

## 12) Домашнее задание — решения/шаблоны

### 12.1 “Математическое округление” (НЕ банковское)
Требуется **ROUND_HALF_UP** (школьное: 2.5→3, -2.5→-3). Встроенный `round()` НЕ подходит. 

Решение через `Decimal`:
```py
from decimal import Decimal, ROUND_HALF_UP

x = Decimal(input("Введите вещественное число: ").strip())
rounded = x.quantize(Decimal("1"), rounding=ROUND_HALF_UP)
print("Округленное значение:", int(rounded))
```

### 12.2 Гипотенуза прямоугольного треугольника
`c = sqrt(a^2 + b^2)` 

```py
import math

a = float(input("Введите длину первого катета: "))
b = float(input("Введите длину второго катета: "))

c = math.sqrt(a**2 + b**2)
print("Длина гипотенузы:", c)
```

---

## 13) Мини-шпаргалка (самое важное)
```text
Встроенные: abs, min, max, pow, sum(iterable), round

round() = банковское: 2.5 -> 2, 3.5 -> 4

Модули: import / from ... import ... / as / (НЕ from ... import *)

math: sqrt, factorial, ceil, floor, pi, e, sin/cos/tan, radians/degrees

float (IEEE 754) -> погрешности: 0.1 + 0.2 != 0.3
Решения: round(...) или Decimal("0.1")

Decimal: создаём из строк, можно задавать округление (ROUND_HALF_UP)
```
